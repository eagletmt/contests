---
layout: post
title: "POJ 1487 - Single-Player Games"
---
[http://poj.org/problem?id=1487](http://poj.org/problem?id=1487)

## 概要
いくつかのラベル付きの部分木が与えられる。
部分木の葉ノードには、整数かラベルが付けられている。
整数はその葉ノードのスコアを表し、ラベルはその位置にそのラベルを持つ部分木が続くことを表している。

各部分木のルートから葉ノードに向かって遷移する。
どの子ノードにも等確率で遷移するとする。
このとき、得られるスコアの期待値を答える。
ただし、その部分木のルートから各葉ノードへ最終的に遷移する確率の合計が 1 にならない場合は「undefined」と答える。

## 制約
- ラベルは小文字のアルファベット1文字。つまり部分木は最大で26個。

## 解法
前半は構文解析。S 式なので大したことはない。

後半は期待値に関する連立方程式を解く。
undefined となるのは任意の値をとれる変数、つまりガウスの消去法を行った後に対角成分が 0 になっているところの変数と、その変数に依存している変数である。

{% include_code lang:cpp poj/1487.cc %}
