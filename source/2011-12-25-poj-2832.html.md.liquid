---
layout: post
title: "POJ 2832 - How Many Pairs?"
---
[http://poj.org/problem?id=2832](http://poj.org/problem?id=2832)

## 概要
頂点数 N，エッジ数 M の無向グラフ G が与えられる．すべてのエッジには長さがある．
Q 個の「`min_pair(u, v) <= A` を見たす u, v の組み合わせの数はいくつか」というクエリに答える．

1. G に含まれる任意の空でないパス p に対して，`max_len(p)` を「p に含まれるエッジの長さの最大値」と定義する
2. Gの頂点 u, v に対して，`min_pair(u, v)` を`min { max_len(p) | p は u, v を繋ぐパス }` と定義する

## 制約
- 1 < N <= 10^4
- 0 < M <= 5 * 10^4
- 0 < Q <= 10^4
- エッジの長さ 0 <= c < 10^8
- 0 <= A < 10^8

## 解法
クラスカル法のイメージで，長さが小さいエッジから Union-Find でノードを併合しながら予め答えを求めておく．
サイズが n の集合とサイズが m の集合を併合するときに組み合わせの数は n \* m 個増えることを利用し，
「長さが c 以下のエッジのみを使った場合の組み合わせの数」を足し合わせながら計算していけばよい．
エッジのソートが必要なので，ここまでで O(M log M)．

あとはクエリがきたときに c に関して二分探索で upper\_bound をとってくれば O(Q log M) でクエリに答えることができる．

{% include_code lang:cpp poj/2832.cc %}
