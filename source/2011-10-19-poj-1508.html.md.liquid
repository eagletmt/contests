---
layout: post
title: "POJ 1508 - Skyscraper Floors"
---
[http://poj.org/problem?id=1508](http://poj.org/problem?id=1508)

## 概要
0 階から F-1 階まである建物に E 個のエレベーターがある．

i 番目のエレベーターは Y[i] より上の階に，Y[i] から X[i] 間隔の階のみに止まることができる．
例えば X[i] = 3, Y[i] = 7 ならば，止まることができる階は 7, 10, 13, 16, ... である．

A 階から B 階までエレベーターのみを使って移動できるかどうかを答える．

## 制約
- 1 <= F < 50000000
- 0 < E < 100
- 0 <= A,B < F
- X > 0
- Y >= 0

## 解法
i 番目のエレベーターから j 番目のエレベーターに乗り換えることができる，つまり同じ階に止まることがあるかどうかがわかれば，
Union-Find でそれらをマージした後，A 階に止まるエレベーターと B 階に止まるエレベーターが同じ集合に含まれているかどうかで判定できる．

(X, Y) = (x0, y0) のエレベーターと (X, Y) = (x1, y1) のエレベーターが同じ階に止まるかどうかは，

    a*x0 + y0 =  b*x1 + y1

を満たす非負整数 (a, b) が存在し，かつ `a*x0 + y0 < F` かどうかに等しい．
このような (a, b) は拡張ユークリッド互除法を利用することで求めることができる．

拡張ユークリッド互除法は

    a*x0 + b*x1 = gcd(x0, x1)

を満たす (a, b) を求めるアルゴリズム．

`y0 - y1` が `gcd(x0, x1)` で割り切れないときに限り，エレベーターが同じ階に止まることがない．
`y0 - y1` が `gcd(x0, x1)` で割り切れるとき，上の拡張ユークリッド互除法の式を少し変形することで，エレベーターの式にもっていくことができる．

コーナーケースとして，A == B のときはどんなエレベーターがきても「可能」と答えることに注意．

{% include_code lang:cpp poj/1508.cc %}
