---
layout: post
title: "POJ 1400 - Complicated Expressions"
---
[http://poj.org/problem?id=1400](http://poj.org/problem?id=1400)

## 概要
括弧と四則演算からなる式が与えられるので，それをできるだけ括弧が少ない形にして出力する．

- すべての二項演算子は左結合．つまり，`(a-b)-c` は `a-b-c` に変換する
- 優先順位は () が最も高く，次に \* と /，最後に \+ と - である．
- \* と \+ に関しては結合則を満たすとする．つまり，`a+(b+c)` は `a+b+c` に変換する
- その他の法則を使ってはならない．例えば `a-(b-c)` を `a-b+c` に変換してはならない

## 制約
- 式は250文字以下
- 入力中に空白は存在しない

## 解法
LL(1) で構文解析して，いわゆるプリティプリンタを実装すればいい．

時間制限が厳しいと思う…
出力するときに string を繋げていくのはもちろんダメで，
ノード用のメモリを実行時に malloc で確保するのもダメだった．

出力はその都度行い，ノード用のメモリはグローバルに用意しておいて free list の要領で割り当てていくようにした…

{% include_code lang:c poj/1400.c %}
