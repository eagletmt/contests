---
layout: post
title: "POJ 3928 - Ping pong"
---
[http://poj.org/problem?id=3928](http://poj.org/problem?id=3928)

## 概要
\\(N\\) 人のプレイヤーが一列に並んでおり、各プレイヤーには一意のランク \\(a\_i\\) が割り当てられている。

卓球のゲームを行うには、2人のプレイヤーと1人の審判が必要である。
このとき、審判は2人のプレイヤーの間にいる人であり、かつ審判のランクは両方のプレイヤーのランクより高かったり、逆に両方のプレイヤーより低かったりしてはならない。

このとき、何通りの試合の組み合わせが存在するかを答える。
いずれかのプレイヤー、または審判が異なる人であれば異なる試合である。

## 制約
- \\(3 \\le N \\le 2 \\cdot 10 ^ 4\\)
- \\(1 \\le a\_i \\le 10 ^ 5\\)

## 解法
\\(i\\) 番目の人が審判になる試合を考えると、組み合わせの数は

- 審判より左側にいてランクが \\(a\_i\\) より低い人 \\(\\times\\) 審判より右側にいてランクが \\(a\_i\\) より高い人
- 審判より左側にいてランクが \\(a\_i\\) より高い人 \\(\\times\\) 審判より右側にいてランクが \\(a\_i\\) より低い人

の和となる。

これは BinaryIndexedTree を用いて \\(O(\\log a\_i)\\) で数えることができ、全体で計算量は \\(O(N \\log a\_i)\\) となって間に合う。

{% include_code lang:cpp poj/3928.cc %}
