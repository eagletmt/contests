---
layout: post
title: "POJ 2167 - Irrelevant Elements"
---
[http://poj.org/problem?id=2167](http://poj.org/problem?id=2167)

## 概要
数列 \\(a\_n\\) がある。
長さ \\(n\\) の数列から、隣接する項の和から新たに長さ \\(n-1\\) の数列を作ることができる。
このとき足し算は \\(\\mbox{mod}\\ m\\) で行う。
これを繰り返して最終的に長さ1の数列を得て、この要素の値を乱数として採用する。

しかしこのとき、最初の数列 \\(a\_n\\) の中で乱数の値に全く影響を及ぼさない要素があるときがある。
そのような要素のインデックスをすべて答える。

## 制約
- \\(1 \\le n \\le 10 ^ 5\\)
- \\(2 \\le m \\le 10 ^ 9\\)

## 解法
最終的に得られる乱数は \\(\\sum\_{i=0} ^ {n-1} {}\_{n-1}\\mathrm{C}\_i a\_i\\) であるので、
\\({}\_{n-1}\\mathrm{C}\_i\\) が \\(m\\) の倍数となるような \\(i\\) をすべて出力すればよい。

階乗の素因数分解は高速に行えるので、\\({}\_{n-1}\\mathrm{C}\_i\\) を階乗の形で表現して素因数分解を行い、\\(m\\) の素因数分解の結果と比較して倍数になっているかどうかを判定する。

{% include_code lang:cpp poj/2167.cc %}
