---
layout: post
title: "POJ 1039 - Pipe"
---
[http://poj.org/problem?id=1039](http://poj.org/problem?id=1039)

## 概要
座標の列 (x[1], y[1]), ..., (x[n], y[n]) が与えられ，(x[1], y[1]), ..., (x[n], y[n]) と (x[1], y[1]-1), ..., (x[n], y[n]-1) からなるパイプを示している (図を見ると意味がわかりやすい)．

(x[1], y[1]) のほうからパイプ内に光を当てたとき，到達しうる最大の x 座標を答える．
ただし，パイプを抜ける場合は「Through all the pipe.」と出力する．

パイプは全く光を通さないし，全く反射もしないとする．

## 制約
- 2 <= n <= 20
- x[1] < x[2] < ... < x[n]

## 解法
直線が最も右側まで伸びるのは

- (x[i], y[i]) と (x[j], y[j]-1) を結んだ直線 (i < j)
- (x[i], y[i]-1) と (x[j], y[j]) を結んだ直線 (i < j)

のいずれか．

`last_index()` でそのような直線がどこまで進めるかを計算し，もし n 番目まで進めるならすぐに「Through all the pipe.」を出力し，そうでなかったら `last_index()` の次の区間での交点を計算して最大値をとる，というように実装した．

{% include_code lang:cpp poj/1039.cc %}
