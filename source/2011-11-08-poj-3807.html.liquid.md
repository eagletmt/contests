---
layout: post
title: "POJ 3807 - Chemist's Math"
---
[http://poj.org/problem?id=3807](http://poj.org/problem?id=3807)

## 概要
係数が省略された化学反応式が与えられるので，正しい係数を答える．

ここで正しい係数とは，

- すべて正の整数
- 係数の gcd が1
- 左辺と右辺で元素の数が一致する

ようなものである．

## 制約
- 化学反応式は80文字以下
- BNF からわかるように，化学反応式中に出現する数値は100未満
- 答えの係数は 40000 以下
- うまく計算すれば途中の計算においても 32-bit の整数値に収まる
- 「正しい」係数は必ず一意に定まる (すなわち例の (8) のような入力は無い)

## 解法
がんばって構文解析した後，有理数でガウスの消去法で連立方程式を解く．
このとき制約から，rank(係数行列) = (変数の数)-1 が保証されている．

{% include_code lang:cpp poj/3807.cc %}
