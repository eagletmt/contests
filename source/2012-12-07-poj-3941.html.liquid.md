---
layout: post
title: "POJ 3941 - Expected Allowance"
---
[http://poj.org/problem?id=3941](http://poj.org/problem?id=3941)

## 概要
\\(n\\) 個の \\(m\\) 面ダイスがある。
各ダイスには \\(1, \\cdots, m\\) の数字が書かれている。
これらの \\(n\\) 個のダイスを振って出た数字の合計から \\(k\\) を引いた値の期待値を答える。
ただし、\\(k\\) を引いた結果が0以下になった場合の値は \\(1\\) とする。

## 制約
- \\(1 \\le n\\)
- \\(2 \\le m\\)
- \\(0 \\le k < nm\\)
- \\((nm) ^ 2 < 10 ^ 8\\)

## 解法
    dp[i][j] := i 個目のダイスまで考えたときに、合計値が j である確率

として、

    dp[i+1][j+k] += dp[i][j] * 1.0/m   for k = 1 .. m

と更新していく。
DP 表のサイズが \\(\\mathrm{O}(n ^ 2 m)\\)、更新コストが \\(\\mathrm{O}(m)\\) なので、
全体の計算量は \\(\\mathrm{O}(n ^ 2 m ^ 2)\\) になる。
ただし、DP 表を更新するときは直前の表しか参照しないので、2つを使い回すことでメモリを節約できる。

これで各値をとりうる確率が計算できるので、あとは普通に期待値を計算すればいい。

{% include_code lang:cpp poj/3941.cc %}
